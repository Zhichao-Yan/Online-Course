### 虚拟内存管理技术：利用程序的访问局部性，高效使用CPU和RAM
* 大多数程序具有的典型特征：访问局部性
    * 时间局部性：向于在不久的将来再次访问最近刚访问过的内存地址
    e.g. 循环累加
    * 空间局部性：倾向于访问在最近访问过的内存地址附近的内存
    e.g. 顺序执行指令，除非函数调用/顺序处理数组内的数据
* 由于访问局部性，即使只有部分地址空间存在于RAM中，依然可能得以执行
    * 之前访问的地址空间仍然在RAM中，再次访问--》时间局部性
    * 之前访问的地址空间附近的地址空间也在RAM中，接着访问--》空间局部性

* 虚拟内存分页技术
    * 把虚拟内存划分成小型、固定大小的页。RAM内存空间划分成和页大小相同的页帧
    * 每个程序只有部分页驻留在物理内存中，构成驻留集。--》RAM中
    * 程序未使用/暂时未使用的页保持在交换区swap。--》磁盘中

* 硬件中分页内存管理单元(PMMU)的支持：要访问的每个虚拟内存地址转换成相应的物理内存地址
* 内核为每个进程维护一张页表
    * 如果需要访问的一个虚拟页面对应的物理页在RAM中--》直接访问内存
    * 如果需要访问的一个虚拟页面对应的物理页在磁盘中--》发生Page fault，内核挂起进程的执行，从磁盘中读入该页到内存
    * 如果进程访问的地址没有对应的表项--》程将收到一个SIGSEGV信号

* 虚拟内存管理的优点
    * 隔离：一个进程不能读取或修改另一进程或内核的内存
        * 进程与进程相互隔离：每个进程的页表指向了不同的RAM物理块集合
        * 进程和内核隔离？？？
    * 共享：不同进程的页表可以指向相同的RAM块
        * 多个进程可以指向相同的代码内存物理块
        * 进程通信：以使用shmget()和mmap()系统调用显式地请求与其他进程共享内存区
    * 程序员和编译器、链接器之类的工具无需关注程序在RAM中的物理布局。
    实现了虚拟地址到物理地址到转换，程序员编译器等只需要关心虚拟地址，映射关系由内核通过页表和PMMU完成
    * 驻留在内存中的只是进程的一部分
        * 每个进程使用的RAM少了--》进程加载执行速度快
        * RAM中可以容纳更多的进程--》更高的并发度
    * 任意时刻内存中至少有一个进程，任意时刻CPU都可以至少执行一个进程，提高了CPU利用率